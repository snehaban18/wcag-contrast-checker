const C="#000000",E="#FFFFFF",R="Sample Text";function g(t){return/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(t)}function m(t){const n=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(n,(a,r,l,u)=>r+r+l+l+u+u);const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}function L(t){const n=[t.r,t.g,t.b].map(e=>(e=e/255,e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)));return .2126*n[0]+.7152*n[1]+.0722*n[2]}function y(t,n){const e=Math.max(t,n),a=Math.min(t,n);return(e+.05)/(a+.05)}function I(t){return{AA:{largeText:t>=3,normalText:t>=4.5},AAA:{largeText:t>=4.5,normalText:t>=7}}}function f(t,n){const e=t==="AA"?4.5:7;return`
    <strong>WCAG 2.1 ${t}:</strong><br>
    Large text (${t==="AA"?3:4.5}:1): <span class="${n.largeText?"text-green-600":"text-red-600"}">${n.largeText?"✓ Pass":"✗ Fail"}</span><br>
    Normal text (${e}:1): <span class="${n.normalText?"text-green-600":"text-red-600"}">${n.normalText?"✓ Pass":"✗ Fail"}</span>
  `}document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("text-color"),n=document.getElementById("bg-color"),e=document.getElementById("text-hex"),a=document.getElementById("bg-hex"),r=document.getElementById("display-text"),l=document.getElementById("contrast-ratio"),u=document.getElementById("aa-normal"),p=document.getElementById("aaa-normal");h(),t.addEventListener("input",()=>{e.value=t.value,r.style.color=t.value,A()}),n.addEventListener("input",()=>{a.value=n.value,r.style.backgroundColor=n.value,A()}),e.addEventListener("input",()=>{g(e.value)&&(t.value=e.value,r.style.color=e.value,A())}),a.addEventListener("input",()=>{g(a.value)&&(n.value=a.value,r.style.backgroundColor=a.value,A())});function i(){s(t,n,C,E),s(e,a,C,E),r.textContent=R,A()}function s(o,c,d,T){o&&(o.value=d),c&&(c.value=T)}function G(o){s(t,n,o.textColor,o.backgroundColor),s(e,a,o.textColor,o.backgroundColor),o.selectedText&&(r.textContent=o.selectedText,r.style.color=o.textColor,r.style.backgroundColor=o.backgroundColor),x(parseFloat(o.contrastRatio),o.compliance)}function h(){chrome.tabs.query({active:!0,currentWindow:!0},o=>{o&&o[0]&&chrome.tabs.sendMessage(o[0].id,{action:"checkContrast"},c=>{if(chrome.runtime.lastError){i();return}c&&c.selectedText?G(c):i()})})}function A(){const o=m(t.value),c=m(n.value),d=L(o),T=L(c),_=y(d,T),v=I(_);x(_,v)}function x(o,c){l.textContent=`Contrast: ${o.toFixed(2)}:1`,u.innerHTML=f("AA",c.AA),p.innerHTML=f("AAA",c.AAA)}});
