const C="#000000",E="#FFFFFF",G="Sample Text";function f(t){return/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(t)}function L(t){const e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(e,(r,l,s,A)=>l+l+s+s+A+A);const n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16)}:null}function p(t){const e=[t.r,t.g,t.b].map(n=>(n=n/255,n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4)));return .2126*e[0]+.7152*e[1]+.0722*e[2]}function y(t,e){const n=Math.max(t,e),r=Math.min(t,e);return(n+.05)/(r+.05)}function I(t){return{AA:{largeText:t>=3,normalText:t>=4.5},AAA:{largeText:t>=4.5,normalText:t>=7}}}function R(t,e){const n=t==="AA"?4.5:7;return`
    <strong>WCAG 2.1 ${t}:</strong><br>
    Large text (${t==="AA"?3:4.5}:1): <span class="${e.largeText?"text-green-600":"text-red-600"}">${e.largeText?"✓ Pass":"✗ Fail"}</span><br>
    Normal text (${n}:1): <span class="${e.normalText?"text-green-600":"text-red-600"}">${e.normalText?"✓ Pass":"✗ Fail"}</span>
  `}document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("text-color"),e=document.getElementById("bg-color"),n=document.getElementById("text-hex"),r=document.getElementById("bg-hex"),l=document.getElementById("display-text"),s=document.getElementById("contrast-ratio"),A=document.getElementById("aa-normal"),v=document.getElementById("aaa-normal");function d(){u(t,e,C,E),u(n,r,C,E),l.textContent=G,c()}function u(o,a,T,i){o&&(o.value=T),a&&(a.value=i)}function x(o){u(t,e,o.textColor,o.backgroundColor),u(n,r,o.textColor,o.backgroundColor),o.selectedText&&(l.textContent=o.selectedText,l.style.color=t.value,l.style.backgroundColor=e.value),g(parseFloat(o.contrastRatio),o.compliance)}function _(){chrome.tabs.query({active:!0,currentWindow:!0},o=>{o&&o[0]&&chrome.tabs.sendMessage(o[0].id,{action:"getSelectedText"},a=>{if(chrome.runtime.lastError){d();return}a&&a.selectedText?x(a):d()})})}d(),chrome.storage.local.get(["contrastResults"],o=>{if(o.contrastResults){const a=o.contrastResults;x(a),a.selectedText||_(),chrome.storage.local.remove(["contrastResults"])}else _()}),t.addEventListener("input",()=>{n.value=t.value,l.style.color=t.value,c()}),e.addEventListener("input",()=>{r.value=e.value,l.style.backgroundColor=e.value,c()}),n.addEventListener("input",()=>{f(n.value)&&(t.value=n.value,l.style.color=n.value,c())}),r.addEventListener("input",()=>{f(r.value)&&(e.value=r.value,l.style.backgroundColor=r.value,c())});function c(){const o=L(t.value),a=L(e.value),T=p(o),i=p(a),m=y(T,i),h=I(m);g(m,h)}function g(o,a){s.textContent=`Contrast: ${o.toFixed(2)}:1`,A.innerHTML=R("AA",a.AA),v.innerHTML=R("AAA",a.AAA)}});
